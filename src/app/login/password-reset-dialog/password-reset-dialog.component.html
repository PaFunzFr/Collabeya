<section class="password-dialog">
  <div class="password-dialog-content">
    <h2>Reset Password</h2>

    <form
      #contactForm="ngForm"
      class="form-login"
    >
      <div class="password-input-wrapper">
        <input
          #password="ngModel"
          [(ngModel)]="passwordInput"
          [type]="passwordVisible ? 'text' : 'password'"
          class="input"
          id="password"
          name="password"
          required
          pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$"
          placeholder="New Password"
        />

        @if (!passwordInput) {
        <div class="icon">
          <img src="./assets/icons/login/lock_black.svg" alt="Password Icon" />
        </div>
        } @if (passwordInput) {
        <div class="icon" (click)="passwordService.togglePasswordVisibility(passwordVisible)">
          <img
            [src]="
              passwordVisible
                ? './assets/icons/login/visibility.svg'
                : './assets/icons/login/visibility_off.svg'
            "
          />
        </div>
        }
      </div>

      <div class="password-input-wrapper">
        <input
          #confirmPassword="ngModel"
          [(ngModel)]="confirmPasswordInput"
          [type]="confirmPasswordVisible ? 'text' : 'password'"
          class="input"
          id="confirmPassword"
          name="confirmPassword"
          required
          placeholder="Confirm New Password"
        />

        @if (!confirmPasswordInput) {
        <div class="icon">
          <img src="./assets/icons/login/lock_black.svg" alt="Password Icon" />
        </div>
        } @if (confirmPasswordInput) {
        <div class="icon" (click)="passwordService.toggleConfirmPasswordVisibility(confirmPasswordVisible)">
          <img
            [src]="
              confirmPasswordVisible
                ? './assets/icons/login/visibility.svg'
                : './assets/icons/login/visibility_off.svg'
            "
          />
        </div>
        } @if (confirmPasswordInput && !passwordService.passwordsMatch) {
        <span class="error-message">Passwords do not match.</span>
        } @else {
        <span class="error-message-placeholder"
          >Passwords do not match.</span
        >
        } @if (password.touched && password.invalid) {
        <span class="error-message-password"
          >Please enter at least 8 characters, including uppercase, lowercase,
          number, and special character.</span
        >
        }
      </div>
    </form>
    <div class="change-password-button-wrapper">
      <button
        class="change-password-button"
        type="submit"
        [disabled]="!passwordService.passwordsMatch"
        (click)="setNewPassword()"
      >
        Apply
      </button>
    </div>
  </div>
</section>
